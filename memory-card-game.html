<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®°å¿†å¡ç‰Œé…å¯¹æ¸¸æˆ</title>
    <!-- Font Awesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ==================== CSS å˜é‡å®šä¹‰ ==================== */
        :root {
            /* æµ…è‰²ä¸»é¢˜é…è‰² */
            --bg-primary: #f0f4f8;
            --bg-secondary: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --accent-color: #4299e1;
            --accent-hover: #3182ce;
            --card-back: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-front: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --shadow-color: rgba(0, 0, 0, 0.1);
            --shadow-hover: rgba(0, 0, 0, 0.2);
            
            /* åŠ¨ç”»å˜é‡ */
            --flip-duration: 0.6s;
            --hover-scale: 1.05;
            --success-scale: 1.1;
        }

        /* æ·±è‰²ä¸»é¢˜é…è‰² */
        [data-theme="dark"] {
            --bg-primary: #1a202c;
            --bg-secondary: #2d3748;
            --text-primary: #e2e8f0;
            --text-secondary: #cbd5e0;
            --accent-color: #63b3ed;
            --accent-hover: #4299e1;
            --card-back: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-front: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --shadow-color: rgba(0, 0, 0, 0.3);
            --shadow-hover: rgba(0, 0, 0, 0.5);
        }

        /* ==================== å…¨å±€æ ·å¼ ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* ==================== é¡¶éƒ¨å¯¼èˆªæ  ==================== */
        .navbar {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px var(--shadow-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .navbar h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .navbar-controls {
            display: flex;
            gap: 1rem;
        }

        /* ==================== æŒ‰é’®æ ·å¼ ==================== */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px var(--shadow-color);
            background: var(--accent-color);
            color: white;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px var(--shadow-hover);
        }

        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 1px 3px var(--shadow-color);
        }

        .btn-icon {
            padding: 0.75rem;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ==================== æ¸¸æˆåŒºåŸŸ ==================== */
        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            gap: 2rem;
        }

        /* éš¾åº¦é€‰æ‹©åŒºåŸŸ */
        .difficulty-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .difficulty-btn {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--accent-color);
        }

        .difficulty-btn.active {
            background: var(--accent-color);
            color: white;
        }

        /* å¡ç‰Œç½‘æ ¼å®¹å™¨ */
        .cards-grid {
            display: grid;
            gap: 1rem;
            perspective: 1000px; /* 3Dé€è§†æ•ˆæœ */
            transition: all 0.3s ease;
        }

        .cards-grid.grid-4x4 {
            grid-template-columns: repeat(4, 120px);
            grid-template-rows: repeat(4, 120px);
        }

        .cards-grid.grid-5x5 {
            grid-template-columns: repeat(5, 110px);
            grid-template-rows: repeat(5, 110px);
        }

        /* ==================== å¡ç‰Œæ ·å¼ ==================== */
        .card {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: pointer;
            transform-style: preserve-3d;
            -webkit-transform-style: preserve-3d;
            -moz-transform-style: preserve-3d;
            -ms-transform-style: preserve-3d;
            transition: transform var(--flip-duration) ease;
        }

        /* ç¿»è½¬åçš„å¡ç‰‡ - ä¿æŒæ—‹è½¬çŠ¶æ€ */
        .card.flipped {
            transform: rotateY(180deg) !important;
            -webkit-transform: rotateY(180deg) !important;
            -moz-transform: rotateY(180deg) !important;
            -ms-transform: rotateY(180deg) !important;
        }

        /* åŒ¹é…æˆåŠŸçš„å¡ç‰‡ - ä¿æŒæ—‹è½¬çŠ¶æ€ */
        .card.matched {
            transform: rotateY(180deg) !important;
            -webkit-transform: rotateY(180deg) !important;
            -moz-transform: rotateY(180deg) !important;
            -ms-transform: rotateY(180deg) !important;
            animation: matchSuccess 0.6s ease forwards;
        }

        /* æœªç¿»è½¬å¡ç‰‡çš„hoveræ•ˆæœ */
        .card:not(.flipped):not(.matched):hover {
            transform: scale(var(--hover-scale));
        }

        /* åŒ¹é…æˆåŠŸåçš„hoverä¸å½±å“transform */
        .card.matched:hover {
            transform: rotateY(180deg) !important;
        }

        @keyframes matchSuccess {
            0% {
                transform: rotateY(180deg) scale(1);
            }
            50% {
                transform: rotateY(180deg) scale(var(--success-scale));
            }
            100% {
                transform: rotateY(180deg) scale(1);
            }
        }

        /* å¡ç‰Œæ­£åé¢ */
        .card-face {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1rem;
            box-shadow: 0 4px 8px var(--shadow-color);
            transition: box-shadow 0.3s ease;
            z-index: 1;
            /* ç¡®ä¿èƒŒé¢éšè— - æ·»åŠ æ‰€æœ‰æµè§ˆå™¨å‰ç¼€ */
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            -moz-backface-visibility: hidden;
            -ms-backface-visibility: hidden;
        }

        /* å¡ç‰ŒèƒŒé¢çš„hoveræ•ˆæœ - åªå¯¹æœªç¿»è½¬çš„å¡ç‰‡ç”Ÿæ•ˆ */
        .card:not(.flipped):not(.matched):hover .card-back {
            box-shadow: 0 8px 16px var(--shadow-hover);
        }

        /* å¡ç‰ŒèƒŒé¢ - åˆå§‹æ˜¾ç¤ºçš„é¢ */
        .card-back {
            background: var(--card-back);
            position: relative;
            overflow: hidden;
        }

        /* ç£¨ç ‚ç»ç’ƒæ•ˆæœ */
        .card-back::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        /* å¡ç‰ŒèƒŒé¢å›¾æ ‡ */
        .card-back i {
            font-size: 3rem;
            color: white;
            z-index: 1;
            opacity: 0.8;
        }

        /* å¡ç‰Œæ­£é¢ - ç¿»è½¬åæ˜¾ç¤ºçš„é¢ */
        .card-front {
            background: var(--card-front);
            transform: rotateY(180deg);
            -webkit-transform: rotateY(180deg);
            -moz-transform: rotateY(180deg);
            -ms-transform: rotateY(180deg);
            z-index: 2;
        }

        .card-front i {
            font-size: 3.5rem;
            color: white;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
            z-index: 3;
            position: relative;
        }

        /* ==================== ä¿¡æ¯æ  ==================== */
        .info-bar {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            border-radius: 1rem;
            box-shadow: 0 2px 10px var(--shadow-color);
            display: flex;
            gap: 3rem;
            align-items: center;
            justify-content: center;
            min-width: 600px;
            transition: background 0.3s ease;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .info-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        /* ==================== èƒœåˆ©å¼¹çª— ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-secondary);
            padding: 3rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 500px;
            transform: translateY(-50px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal {
            transform: translateY(0);
            animation: modalPop 0.5s ease forwards;
        }

        @keyframes modalPop {
            0% {
                transform: scale(0.8) translateY(-50px);
                opacity: 0;
            }
            50% {
                transform: scale(1.05) translateY(0);
            }
            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .modal h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: var(--accent-color);
        }

        .modal-stats {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 2rem 0;
        }

        .modal-stat {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: 0.5rem;
            font-size: 1.1rem;
        }

        .modal-stat-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .modal-stat-value {
            font-weight: 700;
            color: var(--accent-color);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .modal-buttons .btn {
            flex: 1;
        }

        /* ==================== ç²’å­æ•ˆæœ ==================== */
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent-color);
            border-radius: 50%;
            pointer-events: none;
            animation: particleFly 1s ease-out forwards;
        }

        @keyframes particleFly {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 768px) {
            .navbar h1 {
                font-size: 1.5rem;
            }

            .cards-grid.grid-4x4 {
                grid-template-columns: repeat(4, 80px);
                grid-template-rows: repeat(4, 80px);
            }

            .cards-grid.grid-5x5 {
                grid-template-columns: repeat(5, 70px);
                grid-template-rows: repeat(5, 70px);
            }

            .info-bar {
                min-width: auto;
                flex-wrap: wrap;
                gap: 1.5rem;
            }

            .card-front i,
            .card-back i {
                font-size: 2rem;
            }
        }

        /* ==================== æ¸¸æˆæ§åˆ¶æŒ‰é’®åŒºåŸŸ ==================== */
        .game-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* ==================== åŠ è½½åŠ¨ç”» ==================== */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* åº”ç”¨åˆ°å¡ç‰Œå®¹å™¨è€Œä¸æ˜¯å•å¼ å¡ç‰Œï¼Œé¿å…å¹²æ‰°3Dç¿»è½¬ */
        .cards-grid {
            animation: fadeIn 0.8s ease forwards;
        }

        /* ==================== å˜´ç¢å°åŠ©æ‰‹ ==================== */
        .assistant-container {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .assistant-avatar {
            font-size: 4rem;
            background: var(--bg-secondary);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .assistant-avatar:hover {
            transform: scale(1.1);
        }

        .assistant-dialog {
            background: var(--bg-secondary);
            padding: 1rem 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 12px var(--shadow-color);
            max-width: 300px;
            position: relative;
            animation: dialogPop 0.3s ease;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.3s ease;
        }

        .assistant-dialog.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* æ°”æ³¡ä¸‰è§’å½¢ */
        .assistant-dialog::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 10px solid var(--bg-secondary);
        }

        .assistant-text {
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.5;
            min-height: 1.5em;
        }

        .assistant-typing {
            overflow: hidden;
            white-space: pre-wrap;
        }

        /* åŠ©æ‰‹åŠ¨ç”» */
        @keyframes dialogPop {
            from {
                opacity: 0;
                transform: translateX(-20px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        /* å“åº”å¼ï¼šç§»åŠ¨ç«¯è°ƒæ•´åŠ©æ‰‹ä½ç½® */
        @media (max-width: 1024px) {
            .assistant-container {
                left: 10px;
            }

            .assistant-avatar {
                width: 60px;
                height: 60px;
                font-size: 3rem;
            }

            .assistant-dialog {
                max-width: 250px;
                padding: 0.8rem 1.2rem;
            }

            .assistant-text {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            .assistant-container {
                position: relative;
                left: 0;
                top: 0;
                transform: none;
                flex-direction: row;
                align-items: center;
                margin-bottom: 1rem;
                width: 100%;
                justify-content: center;
            }

            .assistant-dialog::before {
                left: 50%;
                top: -10px;
                transform: translateX(-50%);
                border-top: 10px solid var(--bg-secondary);
                border-bottom: 10px solid transparent;
                border-right: 10px solid transparent;
                border-left: 10px solid transparent;
            }

            .assistant-dialog {
                max-width: none;
                width: 80%;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar">
        <h1><i class="fas fa-brain"></i> è®°å¿†å¡ç‰Œé…å¯¹æ¸¸æˆ</h1>
        <div class="navbar-controls">
            <button class="btn btn-icon" id="themeToggle" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-moon"></i>
            </button>
            <button class="btn btn-icon" id="soundToggle" title="éŸ³æ•ˆæ§åˆ¶">
                <i class="fas fa-volume-mute"></i>
            </button>
        </div>
    </nav>

    <!-- å˜´ç¢å°åŠ©æ‰‹ -->
    <div class="assistant-container" id="assistantContainer">
        <div class="assistant-avatar" id="assistantAvatar">ğŸ˜Š</div>
        <div class="assistant-dialog" id="assistantDialog">
            <p class="assistant-text" id="assistantText"></p>
        </div>
    </div>

    <!-- æ¸¸æˆä¸»å®¹å™¨ -->
    <div class="game-container">
        <!-- éš¾åº¦é€‰æ‹© -->
        <div class="difficulty-selector">
            <button class="btn difficulty-btn active" data-difficulty="4">4Ã—4 ç®€å•</button>
            <button class="btn difficulty-btn" data-difficulty="5">5Ã—5 å›°éš¾</button>
        </div>

        <!-- å¡ç‰Œç½‘æ ¼ -->
        <div class="cards-grid grid-4x4" id="cardsGrid"></div>

        <!-- æ¸¸æˆæ§åˆ¶æŒ‰é’® -->
        <div class="game-controls">
            <button class="btn" id="restartBtn">
                <i class="fas fa-redo"></i> é‡æ–°å¼€å§‹
            </button>
        </div>

        <!-- ä¿¡æ¯æ  -->
        <div class="info-bar">
            <div class="info-item">
                <span class="info-label">æ¸¸æˆæ—¶é—´</span>
                <span class="info-value" id="timeDisplay">00:00</span>
            </div>
            <div class="info-item">
                <span class="info-label">ç‚¹å‡»æ­¥æ•°</span>
                <span class="info-value" id="movesDisplay">0</span>
            </div>
            <div class="info-item">
                <span class="info-label">æœ€ä½³è®°å½•</span>
                <span class="info-value" id="bestDisplay">--</span>
            </div>
        </div>
    </div>

    <!-- èƒœåˆ©å¼¹çª— -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h2><i class="fas fa-trophy"></i> æ­å–œè·èƒœï¼</h2>
            <div class="modal-stats">
                <div class="modal-stat">
                    <span class="modal-stat-label">ç”¨æ—¶</span>
                    <span class="modal-stat-value" id="modalTime">00:00</span>
                </div>
                <div class="modal-stat">
                    <span class="modal-stat-label">æ­¥æ•°</span>
                    <span class="modal-stat-value" id="modalMoves">0</span>
                </div>
                <div class="modal-stat">
                    <span class="modal-stat-label">æˆåŠŸç‡</span>
                    <span class="modal-stat-value" id="modalAccuracy">100%</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn" id="playAgainBtn">
                    <i class="fas fa-play"></i> å†ç©ä¸€æ¬¡
                </button>
                <button class="btn" id="closeModalBtn">
                    <i class="fas fa-times"></i> å…³é—­
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== æ¸¸æˆçŠ¶æ€ç®¡ç† ====================
        class MemoryGame {
            constructor() {
                // æ¸¸æˆé…ç½®
                this.difficulty = 4; // é»˜è®¤4x4
                this.cards = [];
                this.flippedCards = [];
                this.matchedPairs = 0;
                this.moves = 0;
                this.time = 0;
                this.timer = null;
                this.isProcessing = false; // é˜²æ­¢å¿«é€Ÿç‚¹å‡»
                this.soundEnabled = false;
                this.audioContext = null; // AudioContextå®ä¾‹ï¼Œç”¨äºæ’­æ”¾éŸ³æ•ˆ
                
                // Font Awesome å›¾æ ‡é›†åˆï¼ˆç”¨äºå¡ç‰Œæ­£é¢ï¼‰
                this.icons = [
                    'fa-star', 'fa-heart', 'fa-bolt', 'fa-crown',
                    'fa-gem', 'fa-fire', 'fa-snowflake', 'fa-leaf',
                    'fa-sun', 'fa-moon', 'fa-cloud', 'fa-anchor',
                    'fa-rocket', 'fa-plane', 'fa-car', 'fa-bicycle',
                    'fa-guitar', 'fa-music', 'fa-bell', 'fa-gift',
                    'fa-key', 'fa-lock', 'fa-unlock', 'fa-flag',
                    'fa-trophy'
                ];

                // DOM å…ƒç´ 
                this.cardsGrid = document.getElementById('cardsGrid');
                this.timeDisplay = document.getElementById('timeDisplay');
                this.movesDisplay = document.getElementById('movesDisplay');
                this.bestDisplay = document.getElementById('bestDisplay');
                this.modalOverlay = document.getElementById('modalOverlay');
                
                // åˆå§‹åŒ–åŠ©æ‰‹
                this.assistant = new GameAssistant();
                
                // åˆå§‹åŒ–
                this.init();
            }

            // ==================== åˆå§‹åŒ–æ¸¸æˆ ====================
            init() {
                this.bindEvents();
                this.loadBestScore();
                this.startNewGame();
            }

            // ==================== ç»‘å®šäº‹ä»¶ç›‘å¬ ====================
            bindEvents() {
                // éš¾åº¦åˆ‡æ¢
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.difficulty = parseInt(e.target.dataset.difficulty);
                        this.cardsGrid.className = `cards-grid grid-${this.difficulty}x${this.difficulty}`;
                        this.loadBestScore(); // åˆ‡æ¢éš¾åº¦åé‡æ–°åŠ è½½æœ€ä½³è®°å½•
                        this.startNewGame();
                    });
                });

                // é‡æ–°å¼€å§‹
                document.getElementById('restartBtn').addEventListener('click', () => {
                    this.startNewGame();
                });

                // ä¸»é¢˜åˆ‡æ¢
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.toggleTheme();
                });

                // éŸ³æ•ˆåˆ‡æ¢
                document.getElementById('soundToggle').addEventListener('click', () => {
                    this.toggleSound();
                });

                // å¼¹çª—æŒ‰é’®
                document.getElementById('playAgainBtn').addEventListener('click', () => {
                    this.closeModal();
                    this.startNewGame();
                });

                document.getElementById('closeModalBtn').addEventListener('click', () => {
                    this.closeModal();
                });
            }

            // ==================== å¼€å§‹æ–°æ¸¸æˆ ====================
            startNewGame() {
                // é‡ç½®æ¸¸æˆçŠ¶æ€
                this.cards = [];
                this.flippedCards = [];
                this.matchedPairs = 0;
                this.moves = 0;
                this.time = 0;
                this.isProcessing = false;
                
                // åœæ­¢è®¡æ—¶å™¨
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                this.updateDisplay();
                
                // é‡ç½®åŠ©æ‰‹ç»Ÿè®¡å¹¶è®©åŠ©æ‰‹è¯´è¯
                this.assistant.resetStats();
                this.assistant.speak('start');
                
                // ç”Ÿæˆå¡ç‰Œ
                this.generateCards();
                this.renderCards();
            }

            // ==================== ç”Ÿæˆå¡ç‰Œæ•°æ®ï¼ˆæ´—ç‰Œç®—æ³•ï¼‰====================
            generateCards() {
                let totalPairs = Math.floor((this.difficulty * this.difficulty) / 2);
                const selectedIcons = this.icons.slice(0, totalPairs);
                
                // åˆ›å»ºé…å¯¹å¡ç‰Œæ•°ç»„
                const cardPairs = [];
                selectedIcons.forEach((icon, index) => {
                    cardPairs.push({ id: index, icon: icon });
                    cardPairs.push({ id: index, icon: icon });
                });
                
                // Fisher-Yates æ´—ç‰Œç®—æ³•ï¼ˆç¡®ä¿çœŸéšæœºï¼‰
                this.cards = this.shuffleArray(cardPairs);
                
                // 5Ã—5æ¨¡å¼ç‰¹æ®Šå¤„ç†ï¼šéœ€è¦25å¼ å¡ï¼ˆ12å¯¹+1å¼ ç‰¹æ®Šå¡ï¼‰
                if (this.difficulty === 5) {
                    // æ·»åŠ ç¬¬13å¼ ç‰¹æ®Šå¡ï¼ˆä¸éœ€è¦é…å¯¹ï¼Œç‚¹å‡»å³åŒ¹é…ï¼‰
                    const specialIcon = this.icons[12]; // ä½¿ç”¨ç¬¬13ä¸ªå›¾æ ‡
                    this.cards.push({ id: 'special', icon: specialIcon, isSpecial: true });
                }
            }

            // ==================== Fisher-Yates æ´—ç‰Œç®—æ³• ====================
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            // ==================== æ¸²æŸ“å¡ç‰Œåˆ°é¡µé¢ ====================
            renderCards() {
                this.cardsGrid.innerHTML = '';
                
                this.cards.forEach((card, index) => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'card';
                    cardElement.dataset.index = index;
                    cardElement.dataset.id = card.id;
                    
                    cardElement.innerHTML = `
                        <div class="card-face card-back">
                            <i class="fas fa-question"></i>
                        </div>
                        <div class="card-face card-front">
                            <i class="fas ${card.icon}"></i>
                        </div>
                    `;
                    
                    cardElement.addEventListener('click', () => this.flipCard(cardElement));
                    this.cardsGrid.appendChild(cardElement);
                });
            }

            // ==================== ç¿»ç‰Œé€»è¾‘ ====================
            flipCard(cardElement) {
                // é˜²æ­¢æ— æ•ˆç‚¹å‡»
                if (this.isProcessing || 
                    cardElement.classList.contains('flipped') || 
                    cardElement.classList.contains('matched')) {
                    return;
                }
                
                // å¦‚æœå·²ç»ç¿»äº†ä¸¤å¼ ç‰Œï¼Œä¸èƒ½å†ç¿»ç¬¬ä¸‰å¼ 
                if (this.flippedCards.length >= 2) {
                    return;
                }

                // ç¬¬ä¸€æ¬¡ç¿»ç‰Œæ—¶å¯åŠ¨è®¡æ—¶å™¨
                if (this.moves === 0 && this.time === 0) {
                    this.startTimer();
                }

                // ç¿»è½¬å¡ç‰Œ
                cardElement.classList.add('flipped');
                this.flippedCards.push(cardElement);
                this.playSound('flip');

                // æ£€æŸ¥é…å¯¹
                if (this.flippedCards.length === 2) {
                    this.moves++;
                    this.updateDisplay();
                    this.checkMatch();
                }
            }

            // ==================== æ£€æŸ¥å¡ç‰Œé…å¯¹ ====================
            checkMatch() {
                this.isProcessing = true;
                const [card1, card2] = this.flippedCards;
                const cardData1 = this.cards[card1.dataset.index];
                const cardData2 = this.cards[card2.dataset.index];
                const id1 = card1.dataset.id;
                const id2 = card2.dataset.id;

                // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šå¡ç‰Œï¼ˆ5x5æ¨¡å¼ä¸­çš„ç¬¬13å¼ å¡ï¼‰
                const isSpecial1 = cardData1 && cardData1.isSpecial;
                const isSpecial2 = cardData2 && cardData2.isSpecial;

                if (id1 === id2 || isSpecial1 || isSpecial2) {
                    // é…å¯¹æˆåŠŸï¼ˆæˆ–ç‚¹å‡»äº†ç‰¹æ®Šå¡ç‰Œï¼‰
                    setTimeout(() => {
                        card1.classList.add('matched');
                        card2.classList.add('matched');
                        this.matchedPairs++;
                        this.playSound('match');
                        this.createParticles(card1);
                        this.createParticles(card2);
                        this.flippedCards = [];
                        this.isProcessing = false;
                        
                        // åŠ©æ‰‹è®°å½•æˆåŠŸå¹¶è¯´è¯
                        this.assistant.recordSuccess();
                        this.assistant.speak('success');
                        
                        // æ£€æŸ¥æ˜¯å¦èƒœåˆ©
                        this.checkWin();
                    }, 500);
                } else {
                    // é…å¯¹å¤±è´¥ï¼Œ1ç§’åç¿»å›
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        this.flippedCards = [];
                        this.isProcessing = false;
                        this.playSound('miss');
                        
                        // åŠ©æ‰‹è®°å½•å¤±è´¥å¹¶è¯´è¯
                        this.assistant.recordFail();
                        this.assistant.speak('fail');
                    }, 1000);
                }
            }

            // ==================== æ£€æŸ¥èƒœåˆ©æ¡ä»¶ ====================
            checkWin() {
                let totalPairs = Math.floor((this.difficulty * this.difficulty) / 2);
                
                // 5x5æ¨¡å¼ç‰¹æ®Šå¤„ç†ï¼š12å¯¹+1å¼ ç‰¹æ®Šå¡=13æ¬¡æˆåŠŸç¿»è½¬
                if (this.difficulty === 5) {
                    totalPairs = 13;
                }
                
                if (this.matchedPairs === totalPairs) {
                    // åœæ­¢è®¡æ—¶å™¨
                    clearInterval(this.timer);
                    
                    // æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ
                    this.playSound('win');
                    
                    // åŠ©æ‰‹åº†ç¥èƒœåˆ©
                    this.assistant.speak('win');
                    
                    // å»¶è¿Ÿæ˜¾ç¤ºå¼¹çª—
                    setTimeout(() => {
                        this.showWinModal();
                    }, 500);
                    
                    // ä¿å­˜æœ€ä½³æˆç»©
                    this.saveBestScore();
                }
            }

            // ==================== æ˜¾ç¤ºèƒœåˆ©å¼¹çª— ====================
            showWinModal() {
                let perfectMoves = (this.difficulty * this.difficulty) / 2;
                
                // 5x5æ¨¡å¼ç‰¹æ®Šå¤„ç†ï¼š13æ¬¡æˆåŠŸç¿»è½¬
                if (this.difficulty === 5) {
                    perfectMoves = 13;
                }
                
                const accuracy = Math.round((perfectMoves / this.moves) * 100);
                
                document.getElementById('modalTime').textContent = this.formatTime(this.time);
                document.getElementById('modalMoves').textContent = this.moves;
                document.getElementById('modalAccuracy').textContent = accuracy + '%';
                
                this.modalOverlay.classList.add('show');
            }

            closeModal() {
                this.modalOverlay.classList.remove('show');
            }

            // ==================== è®¡æ—¶å™¨ç›¸å…³ ====================
            startTimer() {
                this.timer = setInterval(() => {
                    this.time++;
                    this.updateDisplay();
                }, 1000);
            }

            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            // ==================== æ›´æ–°æ˜¾ç¤º ====================
            updateDisplay() {
                this.timeDisplay.textContent = this.formatTime(this.time);
                this.movesDisplay.textContent = this.moves;
            }

            // ==================== æœ¬åœ°å­˜å‚¨ï¼šä¿å­˜æœ€ä½³æˆç»© ====================
            saveBestScore() {
                const storageKey = `best_score_${this.difficulty}x${this.difficulty}`;
                const currentScore = {
                    time: this.time,
                    moves: this.moves
                };
                
                const bestScore = localStorage.getItem(storageKey);
                
                if (!bestScore) {
                    localStorage.setItem(storageKey, JSON.stringify(currentScore));
                    this.loadBestScore();
                } else {
                    const best = JSON.parse(bestScore);
                    // æ¯”è¾ƒï¼šæ­¥æ•°æ›´å°‘æˆ–æ­¥æ•°ç›¸åŒä½†æ—¶é—´æ›´çŸ­
                    if (this.moves < best.moves || (this.moves === best.moves && this.time < best.time)) {
                        localStorage.setItem(storageKey, JSON.stringify(currentScore));
                        this.loadBestScore();
                    }
                }
            }

            // ==================== æœ¬åœ°å­˜å‚¨ï¼šåŠ è½½æœ€ä½³æˆç»© ====================
            loadBestScore() {
                const storageKey = `best_score_${this.difficulty}x${this.difficulty}`;
                const bestScore = localStorage.getItem(storageKey);
                
                if (bestScore) {
                    const best = JSON.parse(bestScore);
                    this.bestDisplay.textContent = `${best.moves}æ­¥/${this.formatTime(best.time)}`;
                } else {
                    this.bestDisplay.textContent = '--';
                }
            }

            // ==================== ä¸»é¢˜åˆ‡æ¢ ====================
            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const themeIcon = document.querySelector('#themeToggle i');
                
                if (currentTheme === 'dark') {
                    document.documentElement.removeAttribute('data-theme');
                    themeIcon.className = 'fas fa-moon';
                    localStorage.setItem('theme', 'light');
                } else {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    themeIcon.className = 'fas fa-sun';
                    localStorage.setItem('theme', 'dark');
                }
            }

            // ==================== éŸ³æ•ˆæ§åˆ¶ ====================
            toggleSound() {
                this.soundEnabled = !this.soundEnabled;
                const soundIcon = document.querySelector('#soundToggle i');
                
                if (this.soundEnabled) {
                    soundIcon.className = 'fas fa-volume-up';
                } else {
                    soundIcon.className = 'fas fa-volume-mute';
                }
            }

            // ==================== æ’­æ”¾éŸ³æ•ˆï¼ˆä½¿ç”¨Web Audio APIï¼‰====================
            playSound(type) {
                if (!this.soundEnabled) return;

                try {
                    // å¤ç”¨AudioContextå®ä¾‹ï¼Œé¿å…æ¯æ¬¡åˆ›å»º
                    if (!this.audioContext) {
                        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }
                    
                    // å¦‚æœAudioContextè¢«æŒ‚èµ·ï¼Œæ¢å¤å®ƒ
                    if (this.audioContext.state === 'suspended') {
                        this.audioContext.resume();
                    }

                    // æ ¹æ®ä¸åŒç±»å‹è®¾ç½®ä¸åŒéŸ³æ•ˆ
                    switch(type) {
                        case 'flip':
                            this.playTone(400, 0.1, 0.1);
                            break;
                        case 'match':
                            this.playTone(600, 0.15, 0.2);
                            break;
                        case 'miss':
                            this.playTone(200, 0.1, 0.15);
                            break;
                        case 'win':
                            // èƒœåˆ©éŸ³æ•ˆï¼ˆè¿ç»­çš„éŸ³ç¬¦ï¼‰
                            const notes = [523, 587, 659, 784];
                            notes.forEach((freq, index) => {
                                setTimeout(() => {
                                    this.playTone(freq, 0.1, 0.3);
                                }, index * 150);
                            });
                            break;
                    }
                } catch (error) {
                    console.warn('éŸ³æ•ˆæ’­æ”¾å¤±è´¥:', error);
                }
            }

            // æ’­æ”¾å•ä¸ªéŸ³è°ƒ
            playTone(frequency, volume, duration) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                // éŸ³é‡æ¸å˜ï¼Œé¿å…çªç„¶å¼€å§‹/ç»“æŸçš„çˆ†éŸ³
                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                gainNode.gain.linearRampToValueAtTime(0, this.audioContext.currentTime + duration);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            // ==================== ç²’å­ç‰¹æ•ˆ ====================
            createParticles(cardElement) {
                const rect = cardElement.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;

                // åˆ›å»º8ä¸ªç²’å­
                for (let i = 0; i < 8; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = centerX + 'px';
                    particle.style.top = centerY + 'px';
                    
                    // éšæœºæ–¹å‘
                    const angle = (Math.PI * 2 * i) / 8;
                    const distance = 50 + Math.random() * 30;
                    const tx = Math.cos(angle) * distance;
                    const ty = Math.sin(angle) * distance;
                    
                    particle.style.setProperty('--tx', tx + 'px');
                    particle.style.setProperty('--ty', ty + 'px');
                    
                    document.body.appendChild(particle);
                    
                    // åŠ¨ç”»ç»“æŸåç§»é™¤
                    setTimeout(() => particle.remove(), 1000);
                }
            }
        }

        // ==================== å˜´ç¢å°åŠ©æ‰‹ç±» ====================
        class GameAssistant {
            constructor() {
                this.avatar = document.getElementById('assistantAvatar');
                this.dialog = document.getElementById('assistantDialog');
                this.text = document.getElementById('assistantText');
                this.typingInterval = null;
                this.recentPhrases = []; // è®°å½•æœ€è¿‘ä½¿ç”¨çš„å°è¯
                this.maxRecent = 5; // è®°å½•æœ€è¿‘5æ¡

                // ä¸°å¯Œçš„å°è¯åº“
                this.phrases = {
                    start: [
                        "å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹å§ï¼",
                        "æ–°æ¸¸æˆå¼€å§‹äº†ï¼Œç¥ä½ å¥½è¿ï¼",
                        "è¿™æ¬¡èƒ½æ‰“ç ´è®°å½•å—ï¼ŸåŠ æ²¹ï¼"
                    ],
                    fail: [
                        "å“å‘€ï¼è¿™è®°å¿†ä¸å¤ªè¡Œå•Š~",
                        "å†æƒ³æƒ³ï¼Œåˆ«æ€¥ç€ç¿»~",
                        "è¿™å±€çœ‹æ¥æœ‰ç‚¹éš¾å“¦ï¼Ÿ",
                        "åˆšæ‰é‚£å¼ å¡ä½ æ²¡è®°ä½å§ï¼Ÿ",
                        "åŠ æ²¹ï¼Œé›†ä¸­æ³¨æ„åŠ›ï¼",
                        "è¿™éƒ½è¢«ä½ ç¿»å‡ºæ¥äº†ï¼Ÿ",
                        "åˆ«æ€¥ï¼Œæ…¢æ…¢æ¥~",
                        "å“ˆå“ˆï¼Œå¤±è¯¯äº†å§ï¼",
                        "è¿™è®°å¿†åŠ›è¿˜éœ€è¦é”»ç‚¼å•Š~",
                        "æ²¡å…³ç³»ï¼Œä¸‹æ¬¡è®°ä½å°±å¥½ï¼",
                        "å“å‘€å‘€ï¼Œåˆç¿»é”™äº†~",
                        "è¿™å¡ç‰Œæ€ä¹ˆè¿™ä¹ˆéš¾è®°ï¼Ÿ",
                        "ä½ çš„å¤§è„‘è¿˜åœ¨é¢„çƒ­å—ï¼Ÿ",
                        "ä»”ç»†ç‚¹ï¼Œåˆ«é©¬è™~",
                        "çœ‹æ¥ä»Šå¤©ä¸åœ¨çŠ¶æ€å•Š~"
                    ],
                    success: [
                        "æ¼‚äº®ï¼å°±è¿™æ ·ä¿æŒï¼",
                        "å‰å®³ï¼è®°æ€§ä¸é”™å˜›~",
                        "è¿™æ³¢æ“ä½œå¾ˆç¨³ï¼",
                        "ç»§ç»­ï¼Œä½ èƒ½è¡Œçš„ï¼",
                        "å¥½æ ·çš„ï¼Œå†æ¥å†å‰ï¼",
                        "è®°å¿†åŠ›è¶…ç¾¤å•Šï¼",
                        "å¤ªæ£’äº†ï¼ç»§ç»­ä¿æŒï¼",
                        "è¿™ååº”é€Ÿåº¦å¯ä»¥å•Šï¼",
                        "ä¸é”™ä¸é”™ï¼Œè¶Šæ¥è¶Šç†Ÿç»ƒäº†ï¼",
                        "è¿™å°±æ˜¯å®åŠ›ï¼",
                        "å®Œç¾çš„ä¸€å¯¹ï¼",
                        "ä½ ä»Šå¤©çŠ¶æ€ä¸é”™ï¼",
                        "è¿™ä¸ªé…å¯¹å¾ˆç²¾å‡†ï¼",
                        "ç»§ç»­åŠ æ²¹ï¼Œé©¬ä¸Šå°±è¦èµ¢äº†ï¼",
                        "è¿™å°±æ˜¯é«˜æ‰‹çš„è¡¨ç°ï¼"
                    ],
                    consecutiveSuccess: [
                        "è¿å¯¹ä¸‰å±€äº†ï¼å¤ªå¼ºäº†ï¼",
                        "è¿™æ˜¯è¦ä¸€æ³¢æµå•Šï¼",
                        "åŠ¿ä¸å¯æŒ¡å•Šï¼",
                        "ä»Šå¤©è¿™æ˜¯å¼€æŒ‚äº†å—ï¼Ÿ",
                        "èŠ‚å¥å®Œå…¨æŒæ§äº†ï¼"
                    ],
                    win: [
                        "å¤ªæ£’äº†ï¼æ­å–œé€šå…³ï¼",
                        "æ­å–œä½ ï¼çœŸæ˜¯ç²¾å½©ï¼",
                        "å®Œç¾é€šå…³ï¼ä½ å¤ªå‰å®³äº†ï¼",
                        "è¿™è¡¨ç°ï¼Œæ— å¯æŒ‘å‰”ï¼",
                        "å¤§ç¥çº§åˆ«ï¼è†œæ‹œï¼"
                    ],
                    consecutiveFail: [
                        "åˆ«ç°å¿ƒï¼Œè°ƒæ•´ä¸€ä¸‹èŠ‚å¥~",
                        "æ·±å‘¼å¸ï¼Œæ…¢æ…¢æ¥~",
                        "ä¼‘æ¯ä¸€ä¸‹çœ¼ç›ï¼Œå†è¯•è¯•ï¼Ÿ"
                    ]
                };

                // è¡¨æƒ…æ˜ å°„
                this.expressions = {
                    default: "ğŸ˜Š",
                    thinking: "ğŸ¤”",
                    happy: "ğŸ˜„",
                    celebrate: "ğŸ‰",
                    cheeky: "ğŸ˜",
                    worried: "ğŸ¤”",
                    trophy: "ğŸ†"
                };

                // ç»Ÿè®¡çŠ¶æ€
                this.consecutiveSuccess = 0;
                this.consecutiveFail = 0;
            }

            // è¯´è¯ï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
            speak(type, forcePhrase = null) {
                // æ¸…é™¤ä¹‹å‰çš„æ‰“å­—
                if (this.typingInterval) {
                    clearInterval(this.typingInterval);
                }

                // è·å–å°è¯
                let phrase;
                if (forcePhrase) {
                    phrase = forcePhrase;
                } else {
                    phrase = this.getRandomPhrase(type);
                }

                // æ›´æ–°è¡¨æƒ…
                this.updateExpression(type);

                // æ˜¾ç¤ºå¯¹è¯æ¡†
                this.dialog.classList.add('show');

                // æ‰“å­—æœºæ•ˆæœ
                let index = 0;
                this.text.textContent = '';
                this.text.classList.add('assistant-typing');

                this.typingInterval = setInterval(() => {
                    if (index < phrase.length) {
                        this.text.textContent += phrase.charAt(index);
                        index++;
                    } else {
                        clearInterval(this.typingInterval);
                        this.text.classList.remove('assistant-typing');
                    }
                }, 50); // æ¯50msæ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦

                // 5ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    this.dialog.classList.remove('show');
                }, 5000);
            }

            // è·å–éšæœºå°è¯ï¼ˆé˜²é‡å¤ï¼‰
            getRandomPhrase(type) {
                const phrases = this.phrases[type];
                if (!phrases || phrases.length === 0) return '';

                // è¿‡æ»¤æ‰æœ€è¿‘ä½¿ç”¨çš„å°è¯
                const available = phrases.filter(p => !this.recentPhrases.includes(p));
                
                // å¦‚æœæ‰€æœ‰å°è¯éƒ½ç”¨è¿‡äº†ï¼Œæ¸…ç©ºè®°å½•
                if (available.length === 0) {
                    this.recentPhrases = [];
                    return phrases[Math.floor(Math.random() * phrases.length)];
                }

                // ä»å¯ç”¨å°è¯ä¸­éšæœºé€‰æ‹©
                const phrase = available[Math.floor(Math.random() * available.length)];
                
                // æ›´æ–°æœ€è¿‘ä½¿ç”¨è®°å½•
                this.recentPhrases.push(phrase);
                if (this.recentPhrases.length > this.maxRecent) {
                    this.recentPhrases.shift();
                }

                return phrase;
            }

            // æ›´æ–°è¡¨æƒ…
            updateExpression(type) {
                let expression;
                switch(type) {
                    case 'start':
                        expression = this.expressions.thinking;
                        break;
                    case 'success':
                        expression = this.expressions.happy;
                        break;
                    case 'consecutiveSuccess':
                        expression = this.expressions.celebrate;
                        break;
                    case 'fail':
                        expression = this.expressions.cheeky;
                        break;
                    case 'consecutiveFail':
                        expression = this.expressions.worried;
                        break;
                    case 'win':
                        expression = this.expressions.trophy;
                        break;
                    default:
                        expression = this.expressions.default;
                }
                this.avatar.textContent = expression;
            }

            // é‡ç½®ç»Ÿè®¡
            resetStats() {
                this.consecutiveSuccess = 0;
                this.consecutiveFail = 0;
            }

            // è®°å½•æˆåŠŸ
            recordSuccess() {
                this.consecutiveSuccess++;
                this.consecutiveFail = 0;

                // è¿ç»­3æ¬¡æˆåŠŸè§¦å‘ç‰¹æ®Šå°è¯
                if (this.consecutiveSuccess >= 3 && this.consecutiveSuccess % 3 === 0) {
                    this.speak('consecutiveSuccess');
                }
            }

            // è®°å½•å¤±è´¥
            recordFail() {
                this.consecutiveFail++;
                this.consecutiveSuccess = 0;

                // è¿ç»­3æ¬¡å¤±è´¥è§¦å‘å®‰æ…°å°è¯
                if (this.consecutiveFail >= 3 && this.consecutiveFail % 3 === 0) {
                    this.speak('consecutiveFail');
                }
            }
        }

        // ==================== é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ¸¸æˆ ====================
        window.addEventListener('DOMContentLoaded', () => {
            // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.querySelector('#themeToggle i').className = 'fas fa-sun';
            }

            // åˆå§‹åŒ–æ¸¸æˆ
            const game = new MemoryGame();
        });
    </script>
</body>
</html>
